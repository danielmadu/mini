extends layout

link(rel='icon', href='/images/logo.ico')

block content
  script
    $(document).ready(function(){
      $('#form_url').validate({
        rules: {
          url: {
            required: true,
            email_valid: true
          }
        }, //end rules

        messages: {
          url: {
            required: 'Por favor, insira a url a ser encurtada.',
            email_valid: 'Está url é invalida.'
          }
        }, //end messages
        errorPlacement: function(error, element) {
          if (element.is(':radio') || element.is(':checkbox')) {
            error.appendTo(element.parent());
          } else {
            error.insertAfter(element);
          } //end errorPlacement
        }
      }); //end validate
    }); //end ready
    jQuery.validator.addMethod("email_valid", function(val, element) {
      var urlregex = new RegExp("^(http:\/\/www.|https:\/\/www.|ftp:\/\/www.|www.|http:\/\/){1}([0-9A-Za-z]+\.)");
      return urlregex.test(val);
    }, "coloca a url");

  h1.logo= title
 
  form(id="form_url", method="post",action= "/generate")
    fieldset(class="border")
      legend Insira uma Url
      p
        label(for="url",id="label_url") Url:
        input(type="text", name="url", id="url",value="http://")

      p.buttons
        input(type="submit", value="Encurtar")
  p
  if(generated)
    p 
      a(href='/'+url_new, title=url_new) #{hostname}#{url_new}
  if(map.length > 0)
    div.urls
      table(class="border")
        thead
          tr
            th As 10 Ultimas Urls encurtadas
        tbody
          each short in map
            tr
              td(width="25%")
                a.short(href= hostname+short.short, title=hostname+short.short ,target='_blank') #{hostname}#{short.short}
                br
                a.url(href= short.url, title=short.url ,target='_blank') #{short.url}


